<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Embed Tableau Server View</title>
	<script type="text/javascript" src="../../../../../wp-includes/js/tinymce/tiny_mce_popup.js"></script>
    <script type="text/Javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>

</head>
<body>
<form border="0" onsubmit="mceInsertTableau(); return false;" action="#submit">
 
    <table width="275" border="0">
      <tr>
        <td width="48"><img src="img/tableau.png" width="32" valign="center" height="33" alt="tableau logo" /></td>
        <td width="217"><strong>Tableau Server View:</strong></td>
      </tr>
    </table>
    <br />
    <table width="275" border="0">
      <tr>
        <td width="79">Server:</td>
        
        <td width="186"><input type="text" id="server_name" tabindex="1" />
        </td>
      </tr>
      <tr>
        <td>Workbook:</td>
        <td><label for="workbook_name"></label>
        <input type="text" name="workbook_name" id="workbook_name" tabindex="2" /></td>
      </tr>
      <tr>
        <td>View:</td>
        <td><label for="view_name"></label>
        <input type="text" name="view_name" id="view_name" tabindex="3" /></td>
      </tr>
    </table>
    <br />
    <fieldset>
    <p align="left"><strong>Embed Parameters:</strong></p>
    <table width="337" border="0">
      <tr>
        <td colspan="3">Display Size:</td>
        <td width="156"><input type="checkbox" name="tabs" id="tabs" tabindex="8" />
        <label for="tabs">Show as tabs</label>
        </td>
      </tr>
      <tr>
        <td width="54">Width</td>
        <td width="37"><label for="width"></label>
          <input type="text" id="width" tabindex="4" size="6" /></td>
        <td width="72"><label for="w_unit" ></label>
          <select name="w_units" id="w_unit" tabindex="5">
            <option value="px" >px</option>
            <option value="per">%</option>
          </select>
        </td>
        <td>
        <input type="checkbox" name="toolbar" id="toolbar" tabindex="9" />
        <label for="toolbar">Show toolbar</label>
        </td>
      </tr>
      <tr>
        <td>Height</td>
        <td><label for="height"></label>
          <input type="text" name="height" id="height" tabindex="6" size="6"/></td>
        <td><label for="h_unit"></label>
          <select name="h_unit" id="h_unit" tabindex="7">
            <option value="px">px</option>
            <option value="per">%</option>
          </select></td>
        <td>
        <input type="checkbox" name="Revert All" id="revert" tabindex="10" />
        <label for="revert">Revert All</label>
        </td>
      </tr>
      <tr>
        <td colspan="3"></td>
        <td><input type="checkbox" name="refresh" id="refr" tabindex="11" />
        Refresh</td>
      </tr>
    </table>
  </fieldset>
    <br />
    <p align="right">
      <input type="button" name="cancel" id="cancel" value="Cancel" onclick="tinyMCEPopup.close();" tabindex="12" />
      <input name="Submit" type="submit" value="OK" tabindex="13" />
    </p>

</form>
<script type="text/javascript">
jQuery("form").submit(function mceInsertTableau($) {
	var inst = tinyMCEPopup.editor, dom = inst.dom;  (function mceInsertTableau($) {
		    var inst = tinyMCEPopup.editor, dom = inst.dom;
			//get form data
	        var server = $("#server_name").val();
	        var workbook = $("#workbook_name").val();
	        var view = $("#view_name").val();
			if ($("#tabs").attr('checked') == true) {
				var tabs = "yes";
			}
			else {
				var tabs = "no";
			}
			var width = jQuery.trim($("#width").val());
			if (width == "") {
				var w_unit = "";
			}
			else {
				var w_unit = $("#w_unit").val();
			}
	        var height = jQuery.trim($("#height").val());
			if (height == "") {
				var h_unit = "";
			}
			else {
				var h_unit = $("#h_unit").val();
			}
			if ($("#toolbar").attr('checked') == true) {
				var toolbar = "yes";
			}
			else {
				var toolbar = "no";
			}
            if ($("#revert").attr('checked') == true) {
				var revert = "yes";
			}
			else {
				var revert = "no";
			}
			if ($("#refr").attr('checked') == true) {
				var refr = "yes";
			}
			else {
				var refr = "no";
			}

			//create shortcode
	        var code =  '\n[tableau server="'+server+'" workbook="'+workbook+'" view="'+view+'" tabs="'+tabs+'" toolbar="'+toolbar+'" revert="'+revert+'" refresh="'+refr+'" width="'+width+''+w_unit+'" height="'+height+''+h_unit+'"][/tableau]\n';    

	 tinyMCEPopup.execCommand('mceInsertContent', false, code);
	 tinyMCEPopup.close();	    
			
			

	}(jQuery));
	

});
function init() {
	tinyMCEPopup.resizeToInnerSize();

	
};
tinyMCEPopup.onInit.add(init);
</script>


</body>
</html>
